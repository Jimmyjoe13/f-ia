# test_csv_ml.fia - Test du chargement de donnÃ©es CSV avec ML
importer "lib/ml.fia" comme ml

imprimer("ğŸŒ¸ === TEST CHARGEMENT DONNÃ‰ES IRIS ===")
imprimer()

# Test chargement CSV
soit dataset = ml.charger_csv("exemples/iris_simple.csv")
imprimer("ğŸ“Š Dataset chargÃ©:", longueur(dataset), "Ã©chantillons")
imprimer("Exemple d'Ã©chantillon:", dataset[0])
imprimer()

# SÃ©paration features/target
soit donnees = ml.separer_features_target(dataset, "species")
soit X = donnees["X"]
soit y = donnees["y"]

imprimer("âœ… Features (X):", longueur(X), "Ã©chantillons,", longueur(X[0]), "caractÃ©ristiques")
imprimer("âœ… Target (y):", longueur(y), "Ã©tiquettes")
imprimer("PremiÃ¨re ligne X:", X[0])
imprimer("PremiÃ¨re Ã©tiquette y:", y[0])
imprimer()

# Preprocessing
soit X_std = ml.standardiser_donnees(X)
imprimer("âš™ï¸ DonnÃ©es standardisÃ©es:")
imprimer("Avant:", X[0])
imprimer("AprÃ¨s:", X_std[0])
imprimer()

# Classification
imprimer("ğŸ¤– === TEST CLASSIFICATION SUR IRIS ===")
soit modele_iris = ml.RandomForestClassifier(100, nul)
ml.entrainer(modele_iris, X_std, y)

# Ã‰valuation
soit precision = ml.evaluer_modele(modele_iris, X_std, y, "accuracy")
imprimer("ğŸ¯ PrÃ©cision Random Forest:", arrondir(precision * 100, 1), "%")

# Validation croisÃ©e
soit validation = ml.validation_croisee(modele_iris, X_std, y, 3)
imprimer("âœ… Validation croisÃ©e:")
imprimer("  PrÃ©cision moyenne:", arrondir(validation["moyenne"] * 100, 1), "%")
imprimer("  Ã‰cart-type:", arrondir(validation["ecart_type"] * 100, 1), "%")
imprimer()

# Test prÃ©diction
soit nouvelles_fleurs = [
    [5.0, 3.0, 1.5, 0.3],  # Probablement setosa
    [6.0, 3.0, 4.5, 1.5],  # Probablement versicolor
    [6.5, 3.0, 5.5, 2.0]   # Probablement virginica
]

soit nouvelles_std = ml.standardiser_donnees(nouvelles_fleurs)
soit predictions = ml.predire(modele_iris, nouvelles_std)

imprimer("ğŸ”® PrÃ©dictions sur nouvelles fleurs:")
pour i dans [0, 1, 2] {
    imprimer("Fleur", i + 1, ":", nouvelles_fleurs[i], "â†’", predictions[i])
}
imprimer()

imprimer("ğŸ‰ === TEST CSV + ML TERMINÃ‰ AVEC SUCCÃˆS ===")
