# seo_main.fia
# Interface principale de l'application SEO F-IA

importer "exemples\seo_analyzer\seo_scraper.fia" comme scraper
importer "exemples\seo_analyzer\seo_analyzer.fia" comme analyzer
importer "exemples\seo_analyzer\seo_reporter.fia" comme reporter

# Interface principale
fonction demarrer_application_seo() {
    afficher_header()
    
    soit continuer = vrai
    tant_que (continuer) {
        afficher_menu()
        soit choix = lire()
        
        si (choix == "1") {
            analyser_url_interactive()
        } sinon si (choix == "2") {
            analyser_urls_multiples()
        } sinon si (choix == "3") {
            afficher_aide()
        } sinon si (choix == "4" ou choix == "q" ou choix == "quitter") {
            continuer = faux
            imprimer("ğŸ‘‹ Merci d'avoir utilisÃ© F-IA SEO Analyzer!")
        } sinon {
            imprimer("âŒ Choix invalide. Veuillez rÃ©essayer.")
        }
        
        si (continuer) {
            imprimer("")
            imprimer("Appuyez sur EntrÃ©e pour continuer...")
            lire()
        }
    }
}

# Affichage de l'en-tÃªte
fonction afficher_header() {
    imprimer("ğŸ” ======================================")
    imprimer("ğŸ‡«ğŸ‡· F-IA SEO ANALYZER v1.0")
    imprimer("ğŸ” ======================================")
    imprimer("ğŸš€ Analyseur SEO en langage franÃ§ais")
    imprimer("âš¡ PropulsÃ© par F-IA v2.0")
    imprimer("")
}

# Affichage du menu
fonction afficher_menu() {
    imprimer("ğŸ“‹ === MENU PRINCIPAL ===")
    imprimer("1ï¸âƒ£ Analyser une URL")
    imprimer("2ï¸âƒ£ Analyse multiple (batch)")
    imprimer("3ï¸âƒ£ Aide et documentation")
    imprimer("4ï¸âƒ£ Quitter")
    imprimer("")
    imprimer("Votre choix: ", "")
}

# Analyse interactive d'une URL
fonction analyser_url_interactive() {
    imprimer("ğŸŒ === ANALYSE SEO D'UNE URL ===")
    imprimer("Entrez l'URL Ã  analyser (avec http:// ou https://): ", "")
    soit url = lire()
    
    si (longueur(url) == 0) {
        imprimer("âŒ URL vide. Retour au menu.")
        retourner nul
    }
    
    # Validation basique
    si (valider_url_basique(url) == faux) {
        imprimer("âŒ URL invalide. Veuillez vÃ©rifier le format.")
        retourner nul
    }
    
    imprimer("")
    imprimer("ğŸ”„ Analyse en cours de:", url)
    imprimer("â³ Veuillez patienter...")
    imprimer("")
    
    # Processus d'analyse complet
    soit donnees = scraper.extraire_contenu_seo(url)
    
    si (donnees["success"]) {
        soit analyse = analyzer.analyser_seo(donnees)
        
        # Affichage des rÃ©sultats
        analyzer.afficher_analyse_seo(analyse)
        
        # Proposition de rapport HTML
        imprimer("ğŸ’¾ Voulez-vous gÃ©nÃ©rer un rapport HTML? (o/n): ", "")
        soit reponse = lire()
        
        si (reponse == "o" ou reponse == "oui" ou reponse == "O") {
            soit nom_fichier = generer_nom_fichier(url)
            soit rapport = reporter.generer_rapport_html(analyse, nom_fichier)
            imprimer("âœ… Rapport sauvegardÃ©:", rapport["fichier"])
        }
        
    } sinon {
        imprimer("âŒ Erreur lors de l'analyse:", donnees["erreur"])
    }
}

# Analyse multiple
fonction analyser_urls_multiples() {
    imprimer("ğŸ“š === ANALYSE MULTIPLE ===")
    imprimer("Entrez les URLs une par une (ligne vide pour finir):")
    
    soit urls = []
    soit compteur = 1
    
    tant_que (vrai) {
        imprimer("URL " + chaine(compteur) + ": ", "")
        soit url = lire()
        
        si (longueur(url) == 0) {
            stopper
        }
        
        si (valider_url_basique(url)) {
            ajouter(urls, url)
            compteur += 1
        } sinon {
            imprimer("âŒ URL invalide ignorÃ©e:", url)
        }
    }
    
    si (longueur(urls) == 0) {
        imprimer("âŒ Aucune URL valide fournie.")
        retourner nul
    }
    
    imprimer("")
    imprimer("ğŸ“Š Analyse de", longueur(urls), "URL(s)...")
    imprimer("")
    
    soit resultats = []
    soit numero = 1
    
    pour url dans urls {
        imprimer("ğŸ”„ [" + chaine(numero) + "/" + chaine(longueur(urls)) + "] Analyse:", url)
        
        soit donnees = scraper.extraire_contenu_seo(url)
        
        si (donnees["success"]) {
            soit analyse = analyzer.analyser_seo(donnees)
            ajouter(resultats, analyse)
            imprimer("âœ… Score:", analyse["score_global"], "/100")
        } sinon {
            imprimer("âŒ Ã‰chec:", donnees["erreur"])
        }
        
        numero += 1
        imprimer("")
    }
    
    # RÃ©sumÃ© final
    afficher_resume_multiple(resultats)
}

# Affichage de l'aide
fonction afficher_aide() {
    imprimer("ğŸ“– === AIDE F-IA SEO ANALYZER ===")
    imprimer("")
    imprimer("ğŸ¯ FONCTIONNALITÃ‰S:")
    imprimer("â€¢ Analyse complÃ¨te SEO (titre, meta, contenu, structure)")
    imprimer("â€¢ Score global sur 100 points")
    imprimer("â€¢ Recommandations personnalisÃ©es")
    imprimer("â€¢ Rapports HTML dÃ©taillÃ©s")
    imprimer("â€¢ Analyse multiple (batch)")
    imprimer("")
    imprimer("ğŸ“ CRITÃˆRES D'ANALYSE:")
    imprimer("â€¢ Titre: longueur optimale (30-60 caractÃ¨res)")
    imprimer("â€¢ Meta description: longueur optimale (120-160 caractÃ¨res)")
    imprimer("â€¢ Contenu: nombre de mots, densitÃ© mots-clÃ©s")
    imprimer("â€¢ Structure: hiÃ©rarchie des titres (H1, H2, etc.)")
    imprimer("â€¢ Images: prÃ©sence et attributs alt")
    imprimer("â€¢ Liens: maillage interne et externe")
    imprimer("â€¢ Technique: taille de page, structure URL")
    imprimer("")
    imprimer("ğŸŒ FORMATS URL SUPPORTÃ‰S:")
    imprimer("â€¢ https://exemple.com")
    imprimer("â€¢ http://exemple.com")
    imprimer("â€¢ https://www.exemple.com/page")
    imprimer("")
    imprimer("ğŸ’¡ CONSEILS:")
    imprimer("â€¢ Testez d'abord avec une URL pour comprendre le systÃ¨me")
    imprimer("â€¢ Les rapports HTML sont sauvegardÃ©s dans le dossier 'rapports/'")
    imprimer("â€¢ Score 80+ = Excellent, 60+ = Bon, 40+ = Moyen, <40 = Ã€ amÃ©liorer")
}

# Fonctions utilitaires
fonction valider_url_basique(url) {
    # Version sans dÃ©pendance au module texte pour Ã©viter les conflits
    soit contient_http = url != remplacer(url, "http://", "")
    soit contient_https = url != remplacer(url, "https://", "")
    retourner (contient_http ou contient_https) et longueur(url) > 10
}

fonction generer_nom_fichier(url) {
    # Extraction simple du domaine pour le nom de fichier
    soit domaine_brut = remplacer(url, "https://", "")
    domaine_brut = remplacer(domaine_brut, "http://", "")
    domaine_brut = remplacer(domaine_brut, "www.", "")
    
    # Prendre seulement la partie avant le premier /
    soit parties = diviser(domaine_brut, "/")
    soit domaine = parties[0]
    
    soit nom_propre = remplacer(domaine, ".", "_")
    nom_propre = remplacer(nom_propre, "-", "_")
    retourner "rapport_seo_" + nom_propre
}

fonction afficher_resume_multiple(resultats) {
    si (longueur(resultats) == 0) {
        retourner nul
    }
    
    imprimer("ğŸ“Š === RÃ‰SUMÃ‰ DE L'ANALYSE MULTIPLE ===")
    imprimer("ğŸ“ˆ Sites analysÃ©s:", longueur(resultats))
    
    soit total_score = 0
    soit meilleur_score = 0
    soit pire_score = 100
    
    pour resultat dans resultats {
        total_score += resultat["score_global"]
        si (resultat["score_global"] > meilleur_score) {
            meilleur_score = resultat["score_global"]
        }
        si (resultat["score_global"] < pire_score) {
            pire_score = resultat["score_global"]
        }
    }
    
    soit score_moyen = arrondir(total_score / longueur(resultats), 1)
    
    imprimer("ğŸ“Š Score moyen:", score_moyen, "/100")
    imprimer("ğŸ† Meilleur score:", meilleur_score, "/100")
    imprimer("ğŸ“‰ Score le plus faible:", pire_score, "/100")
    
    imprimer("")
    imprimer("ğŸ“‹ DÃ‰TAIL PAR SITE:")
    soit numero = 1
    pour resultat dans resultats {
        imprimer(chaine(numero) + ". " + resultat["url"] + " - Score: " + chaine(resultat["score_global"]) + "/100")
        numero += 1
    }
}

# Point d'entrÃ©e principal
imprimer("ğŸš€ DÃ©marrage de F-IA SEO Analyzer...")
demarrer_application_seo()
